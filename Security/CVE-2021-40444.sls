##os: Windows
# Created: 2021-09Sep-09
# https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444
# Microsoft is investigating reports of a remote code execution vulnerability in MSHTML that affects Microsoft Windows. 
# Microsoft is aware of targeted attacks that attempt to exploit this vulnerability by using specially-crafted Microsoft Office documents.
# An attacker could craft a malicious ActiveX control to be used by a Microsoft Office document that hosts the browser rendering engine. 
# The attacker would then have to convince the user to open the malicious document. Users whose accounts are configured to have fewer 
# user rights on the system could be less impacted than users who operate with administrative user rights.

# Workaround: Disabling the installation of all ActiveX controls in Internet Explorer mitigates this attack. This can be accomplished 
# for all sites by configuring the Group Policy using your Local Group Policy Editor or by updating the registry. Previously-installed 
# ActiveX controls will continue to run, but do not expose this vulnerability.

Set_My_Computer_Zone_Block_Signed_ActiveX:
  reg.present:
    - name: HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0
    - vname: '1001'
    - vdata: 00000003
    - vtype: REG_DWORD

Set_My_Computer_Zone_Block_Unsigned_ActiveX:
  reg.present:
    - name: HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0
    - vname: '1004'
    - vdata: 00000003
    - vtype: REG_DWORD

Set_Local_Intranet_Zone_Block_Signed_ActiveX:
  reg.present:
    - name: HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\1
    - vname: '1001'
    - vdata: 00000003
    - vtype: REG_DWORD

Set_Local_Intranet_Zone_Block_Unsigned_ActiveX:
  reg.present:
    - name: HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\1
    - vname: '1004'
    - vdata: 00000003
    - vtype: REG_DWORD

Set_Trusted_Sites_Zone_Block_Signed_ActiveX:
  reg.present:
    - name: HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\2
    - vname: '1001'
    - vdata: 00000003
    - vtype: REG_DWORD

Set_Trusted_Sites_Zone_Block_Unsigned_ActiveX:
  reg.present:
    - name: HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\2
    - vname: '1004'
    - vdata: 00000003
    - vtype: REG_DWORD

Set_Internet_Zone_Block_Signed_ActiveX:
  reg.present:
    - name: HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\3
    - vname: '1001'
    - vdata: 00000003
    - vtype: REG_DWORD

Set_Internet_Zone_Block_Unsigned_ActiveX:
  reg.present:
    - name: HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\3
    - vname: '1004'
    - vdata: 00000003
    - vtype: REG_DWORD